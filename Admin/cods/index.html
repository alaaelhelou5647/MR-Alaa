<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
  <title>Ù†Ø¸Ø§Ù… Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Â· Ø¥ØµØ¯Ø§Ø± Ø³Ù‡Ù„ ÙˆÙˆØ±Ù‚ÙŠ</title>
  
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <style>
    /* ========== ğŸŒŸ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ â€“ Ø³Ù‡Ù„ØŒ Ù†Ø¸ÙŠÙØŒ Ù…Ø±Ù† ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #0f5e8c;
      --primary-light: #2c7aa0;
      --primary-dark: #0a405a;
      --accent: #ff914d;
      --accent-light: #ffb085;
      --success: #1e8d5c;
      --danger: #c13b3b;
      --warning: #d98c1c;
      --gray-bg: #f7faff;
      --card-white: #ffffff;
      --soft-border: #e4ecf5;
      --text-dark: #193441;
      --text-soft: #3e5e6b;
      --shadow-soft: 0 12px 28px -8px rgba(0,40,60,0.06);
      --radius-card: 28px;
      --radius-btn: 60px;
    }

    body {
      font-family: 'Tajawal', sans-serif;
      background: #f4f9fd;
      color: var(--text-dark);
      padding: 22px;
      min-height: 100vh;
    }

    .container {
      max-width: 1500px;
      margin: 0 auto;
    }

    /* ========== ğŸ§­ Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¨Ø³ÙŠØ· ========== */
    .easy-header {
      background: white;
      border-radius: var(--radius-card);
      padding: 24px 32px;
      margin-bottom: 25px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--soft-border);
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo-icon {
      background: var(--primary);
      color: white;
      width: 58px;
      height: 58px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      box-shadow: 0 8px 14px rgba(15,94,140,0.2);
    }

    .logo-text h1 {
      font-size: 1.9rem;
      font-weight: 800;
      color: var(--primary-dark);
      line-height: 1.2;
    }

    .logo-text span {
      font-size: 1rem;
      color: var(--text-soft);
      font-weight: 500;
    }

    .stats-mini {
      display: flex;
      gap: 30px;
      background: #eaf0f5;
      padding: 14px 30px;
      border-radius: 60px;
    }

    .stats-mini span {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-dark);
    }

    .stats-mini i {
      color: var(--accent);
    }

    /* ========== ğŸ“Š ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙˆØ§Ø¶Ø­Ø© ========== */
    .stat-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }

    .stat-item {
      background: white;
      border-radius: 26px;
      padding: 22px 20px;
      display: flex;
      align-items: center;
      gap: 18px;
      border: 1px solid var(--soft-border);
      transition: all 0.2s;
      box-shadow: 0 6px 14px rgba(0,0,0,0.01);
    }

    .stat-item:hover {
      border-color: var(--primary);
      background: #fafdff;
    }

    .stat-emoji {
      width: 60px;
      height: 60px;
      background: #f0f8fe;
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }

    .stat-details h4 {
      font-size: 0.9rem;
      color: var(--text-soft);
      font-weight: 500;
      margin-bottom: 6px;
    }

    .stat-details p {
      font-size: 2.1rem;
      font-weight: 800;
      color: var(--primary-dark);
      line-height: 1;
    }

    /* ========== ğŸ” ØªØ­ÙƒÙ… ÙˆØ¨Ø­Ø« Ø³Ù‡Ù„ ========== */
    .action-bar {
      background: white;
      border-radius: 80px;
      padding: 16px 24px;
      margin-bottom: 30px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 18px;
      box-shadow: 0 8px 18px rgba(0,0,0,0.02);
      border: 1px solid #dae6ed;
    }

    .search-simple {
      flex: 2;
      min-width: 260px;
      position: relative;
    }

    .search-simple i {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary);
      font-size: 1.2rem;
    }

    .search-simple input {
      width: 100%;
      padding: 16px 55px 16px 25px;
      border: 2px solid #deecf2;
      border-radius: 60px;
      font-family: 'Tajawal', sans-serif;
      font-size: 1.1rem;
      background: #fbfeff;
      transition: 0.2s;
    }

    .search-simple input:focus {
      border-color: var(--primary);
      outline: none;
      background: white;
      box-shadow: 0 0 0 4px rgba(15,94,140,0.06);
    }

    .filter-easy {
      display: flex;
      gap: 6px;
      background: #f0f5fa;
      padding: 6px;
      border-radius: 60px;
    }

    .filter-option {
      padding: 12px 26px;
      border: none;
      border-radius: 60px;
      font-weight: 700;
      font-size: 1rem;
      background: transparent;
      color: var(--text-soft);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: 0.15s;
    }

    .filter-option.active {
      background: var(--primary);
      color: white;
    }

    .btn-group {
      display: flex;
      gap: 12px;
      margin-right: auto;
    }

    .btn {
      padding: 14px 28px;
      border: none;
      border-radius: 60px;
      font-weight: 700;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: 0.2s;
      background: white;
      border: 2px solid var(--soft-border);
      color: var(--text-dark);
    }

    .btn i { font-size: 1.2rem; }

    .btn-primary {
      background: var(--primary);
      color: white;
      border: none;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 12px 18px rgba(15,94,140,0.2);
    }

    .btn-success {
      background: var(--success);
      color: white;
      border: none;
    }

    .btn-success:hover {
      background: #146b45;
      transform: translateY(-2px);
    }

    .print-badge {
      background: white;
      color: var(--primary);
      padding: 4px 14px;
      border-radius: 60px;
      font-weight: 800;
      margin-right: 6px;
    }

    /* ========== ğŸ§© Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª â€“ ÙƒØ±ÙˆØª Ù…Ø±ÙŠØ­Ø© ========== */
    .lectures-easy-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 26px;
    }

    .lecture-simple-card {
      background: white;
      border-radius: 32px;
      padding: 24px;
      border: 1px solid var(--soft-border);
      transition: all 0.2s;
      box-shadow: 0 6px 16px rgba(0,0,0,0.02);
    }

    .lecture-simple-card:hover {
      border-color: var(--accent-light);
      box-shadow: 0 20px 28px -10px rgba(255,145,77,0.1);
    }

    .lecture-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .lecture-name {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--primary-dark);
    }

    .lecture-name i { color: var(--accent); }

    .paid-badge {
      background: #fff6e5;
      padding: 10px 22px;
      border-radius: 60px;
      font-size: 0.95rem;
      font-weight: 700;
      color: #b95b0a;
    }

    .lecture-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 22px;
      background: #f8fdff;
      padding: 14px 18px;
      border-radius: 60px;
    }

    .meta-tag {
      display: flex;
      align-items: center;
      gap: 8px;
      background: white;
      padding: 8px 20px;
      border-radius: 60px;
      border: 1px solid #d8e5ec;
      font-size: 0.95rem;
    }

    .price-highlight {
      background: #fff3d9;
      border-color: #ffcd94;
      color: #8f4d0c;
    }

    /* ========== ğŸ”¢ Ù‚Ø³Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ â€“ Ù…ÙÙ‡ÙˆÙ… ÙˆÙ…Ø¶ØºÙˆØ· ========== */
    .codes-mini-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .codes-mini-header h3 {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.2rem;
    }

    .code-stats-badge {
      background: var(--primary);
      color: white;
      padding: 6px 22px;
      border-radius: 60px;
      font-size: 0.95rem;
    }

    .codes-mini-list {
      max-height: 560px;
      overflow-y: auto;
      padding-left: 4px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* ---- ÙƒÙˆØ¯ ÙƒØ§Ø±Ø¯ Ù…Ø¶ØºÙˆØ· ØŒ ØªÙˆÙÙŠØ± Ù…Ø³Ø§Ø­Ø© ØŒ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¨Ø§ÙŠÙ†Ø© ---- */
    .code-mini-item {
      background: #fafeff;
      border-radius: 24px;
      padding: 18px;
      border: 2px solid #e2f0f5;
      transition: 0.1s;
      position: relative;
    }

    .code-mini-item.used {
      background: #fff7f5;
      border-color: #ffdbd4;
    }

    .code-mini-item.unused {
      background: #f6fffa;
      border-color: #c6efcf;
    }

    .row-1 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 14px;
    }

    .status-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 20px;
      border-radius: 60px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .chip-used {
      background: #ffe6e2;
      color: #ac3c2e;
    }

    .chip-unused {
      background: #dcf5e0;
      color: #0e6a3a;
    }

    .lecture-tag-sm {
      background: white;
      padding: 6px 20px;
      border-radius: 60px;
      border: 1px solid #cde1e9;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .code-price-sm {
      background: #fff6df;
      padding: 10px 18px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 14px;
      font-weight: 700;
      color: #6b430a;
      border: 1px solid #ffe4ae;
    }

    .code-digits {
      font-size: 1.9rem;
      font-weight: 800;
      font-family: 'Courier New', monospace;
      direction: ltr;
      text-align: center;
      background: white;
      padding: 14px;
      border-radius: 20px;
      border: 3px dashed var(--primary-light);
      letter-spacing: 5px;
      margin-bottom: 16px;
    }

    .code-footer-simple {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    .date-small {
      color: var(--text-soft);
      font-size: 0.85rem;
      display: flex;
      gap: 5px;
    }

    .select-btn {
      background: white;
      border: 2px solid var(--primary);
      padding: 10px 26px;
      border-radius: 60px;
      font-weight: 700;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: 0.15s;
      font-size: 0.95rem;
    }

    .select-btn:hover {
      background: var(--primary);
      color: white;
    }

    .select-btn.selected {
      background: var(--success);
      border-color: var(--success);
      color: white;
    }

    /* Ø²Ø±Ø§ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© ÙˆØ§Ø¶Ø­Ø© */
    .lecture-simple-actions {
      display: flex;
      gap: 14px;
      margin-top: 24px;
    }

    .action-simple {
      flex: 1;
      padding: 14px;
      border-radius: 60px;
      border: none;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: #edf6fa;
      color: var(--primary-dark);
      cursor: pointer;
      transition: 0.15s;
    }

    .action-simple:hover {
      background: #dbeaf0;
    }

    .add-code-btn {
      background: #ffe4d6;
      color: #b3440e;
    }

    /* ========== ğŸ–¨ï¸ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© â€“ Ù…ÙˆÙØ±Ø© Ù„Ù„ÙˆØ±Ù‚ Ø¬Ø¯Ø§Ù‹ ========== */
    .print-panel {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 30, 40, 0.9);
      backdrop-filter: blur(6px);
      z-index: 9999;
      padding: 25px;
      overflow-y: auto;
    }

    .print-paper {
      max-width: 1300px;
      margin: 0 auto;
      background: white;
      border-radius: 36px;
      padding: 30px;
    }

    .print-header-simple {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid var(--primary);
    }

    /* ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢  Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© â€“ Ø¶Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙˆÙ…ÙˆÙØ±Ø© Ù„Ù„ÙˆØ±Ù‚  ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ */
    .print-codes-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr); /* 4 ÙƒØ±ÙˆØª ÙÙŠ Ø§Ù„ØµÙ â€“ ØªÙˆÙÙŠØ± ÙˆØ±Ù‚ */
      gap: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ÙØ¬ÙˆØ© */
    }

    .print-code-card {
      border: 1px solid #222;
      padding: 12px 8px;
      border-radius: 16px;
      font-size: 11px;
      line-height: 1.4;
      background: white;
      page-break-inside: avoid;
      display: flex;
      flex-direction: column;
    }

    /* Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ÙÙ‚Ø· Ù†Ø¶ØºØ· Ø§ÙƒØªØ± */
    @media print {
      body * { visibility: hidden; }
      .print-panel, .print-panel * { visibility: visible; }
      .print-panel { position: absolute; top: 0; left: 0; width: 100%; background: white; }
      .print-codes-grid { grid-template-columns: repeat(4, 1fr); gap: 6px; }
      .print-code-card { border: 1px solid black; break-inside: avoid; }
      .no-print { display: none; }
    }

    .btn-close-print {
      background: var(--danger);
      color: white;
      border: none;
      border-radius: 60px;
      padding: 14px 30px;
      font-weight: 700;
    }
    
    /* Ø³Ù‡ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… */
    .empty-friendly {
      grid-column: 1/-1;
      text-align: center;
      padding: 70px;
      background: white;
      border-radius: 48px;
    }

    /* Ù…Ø±ÙˆÙ†Ø© ØªØ§Ù…Ø© */
    @media (max-width: 1000px) {
      .lectures-easy-grid { grid-template-columns: 1fr; }
      .print-codes-grid { grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 700px) {
      .action-bar { border-radius: 30px; }
      .btn-group { margin-right: 0; width: 100%; }
      .print-codes-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- ========== Ù‡ÙŠØ¯Ø± Ø³Ù‡Ù„ ÙˆØ¨Ø³ÙŠØ· ========== -->
  <div class="easy-header no-print">
    <div class="logo-area">
      <div class="logo-icon">
        <i class="fas fa-ticket-simple"></i>
      </div>
      <div class="logo-text">
        <h1>ÙƒÙˆØ¯ Ù…Ø­Ø§Ø¶Ø±Ø§ØªÙŠ</h1>
        <span>Ù†Ø¸Ø§Ù… Ø®ÙÙŠÙ Â· Ø³Ù‡Ù„ Â· Ù…ÙˆÙØ± Ù„Ù„ÙˆØ±Ù‚</span>
      </div>
    </div>
    <div class="stats-mini">
      <span><i class="fas fa-video"></i> <span id="headerLectures">0</span></span>
      <span><i class="fas fa-key"></i> <span id="headerCodes">0</span></span>
      <span><i class="fas fa-check-double"></i> <span id="headerSelected">0</span> Ù…Ø­Ø¯Ø¯</span>
    </div>
  </div>

  <!-- ========== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒØ±ÙˆØª ========== -->
  <div class="stat-cards no-print">
    <div class="stat-item">
      <div class="stat-emoji">ğŸ”‘</div>
      <div class="stat-details">
        <h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</h4>
        <p id="statTotalCodes">0</p>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-emoji">âœ…</div>
      <div class="stat-details">
        <h4>ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…</h4>
        <p id="statUnusedCodes">0</p>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-emoji">âŒ</div>
      <div class="stat-details">
        <h4>Ù…Ø³ØªØ®Ø¯Ù…</h4>
        <p id="statUsedCodes">0</p>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-emoji">ğŸ–¨ï¸</div>
      <div class="stat-details">
        <h4>Ù…Ø­Ø¯Ø¯ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</h4>
        <p id="statSelectedPrint">0</p>
      </div>
    </div>
  </div>

  <!-- ========== Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³Ù‡Ù„ ========== -->
  <div class="action-bar no-print">
    <div class="search-simple">
      <i class="fas fa-search"></i>
      <input type="text" id="simpleSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©ØŒ Ø§Ù„ÙƒÙˆØ¯ØŒ Ø§Ù„ØµÙ ...">
    </div>
    
    <div class="filter-easy">
      <button class="filter-option active" onclick="window.setFilter('all', this)"><i class="fas fa-globe"></i> Ø§Ù„ÙƒÙ„</button>
      <button class="filter-option" onclick="window.setFilter('unused', this)"><i class="fas fa-check-circle"></i> ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…</button>
      <button class="filter-option" onclick="window.setFilter('used', this)"><i class="fas fa-times-circle"></i> Ù…Ø³ØªØ®Ø¯Ù…</button>
    </div>

    <div class="btn-group">
      <button class="btn btn-primary" onclick="window.openPrintView()">
        <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
        <span class="print-badge" id="printCountBadge">0</span>
      </button>
      <button class="btn btn-success" onclick="window.generateForAll()">
        <i class="fas fa-plus"></i> ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯
      </button>
    </div>
  </div>

  <!-- ========== Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª â€“ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ ÙƒØ±ÙˆØª ========== -->
  <div id="lecturesEasyContainer" class="lectures-easy-grid">
    <!-- ÙŠØªÙ… Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
  </div>
</div>

<!-- ========== Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…ÙˆÙØ±Ø© Ø¬Ø¯Ø§Ù‹ ========== -->
<div id="printPanel" class="print-panel no-print">
  <div class="print-paper">
    <div class="print-header-simple">
      <div style="display: flex; align-items: center; gap: 12px;">
        <i class="fas fa-ticket-alt" style="font-size: 2.2rem; color: var(--primary);"></i>
        <h2 style="font-size: 1.8rem;">Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</h2>
      </div>
      <div>
        <span style="background: var(--primary); color: white; padding: 8px 28px; border-radius: 60px;" id="printDateSpan"></span>
      </div>
    </div>
    
    <!-- Ø´Ø¨ÙƒØ© Ø·Ø¨Ø§Ø¹Ø© â€“ 4 Ø£Ø¹Ù…Ø¯Ø© â€“ ØªÙˆÙÙŠØ± ÙˆØ±Ù‚ Ù…Ø°Ù‡Ù„ -->
    <div id="printCodesContainer" class="print-codes-grid">
      <!-- Ù‡Ù†Ø§ Ø§Ù„ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¶ØºÙˆØ·Ø© -->
    </div>
    
    <div style="display: flex; gap: 18px; justify-content: center; margin-top: 40px;" class="no-print">
      <button class="btn btn-primary" onclick="window.printPaper()">
        <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
      </button>
      <button class="btn btn-close-print" onclick="window.closePrintPanel()">
        <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
      </button>
    </div>
  </div>
</div>

<script type="module">
  // ========== ğŸ”¥ Firebase Config ==========
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, getDocs, doc, setDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCTLfpSbUAhiKFKE7xAUrQUL5-Lravz9wk",
    authDomain: "lectures-123.firebasestorage.app",
    projectId: "lectures-123",
    storageBucket: "lectures-123.firebasestorage.app",
    messagingSenderId: "973877461046",
    appId: "1:973877461046:web:3f592e25dc5cccc2acd897"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ==========
  window.lectures = [];
  window.codes = [];
  window.selectedCodes = [];
  window.filterStatus = 'all';
  window.searchWord = '';

  // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==========
  window.loadData = async function() {
    try {
      const lecSnap = await getDocs(collection(db, "lectures"));
      window.lectures = lecSnap.docs.map(d => ({ id: d.id, ...d.data() }));
      
      const codeSnap = await getDocs(collection(db, "codes"));
      window.codes = codeSnap.docs.map(d => ({ 
        firebaseId: d.id, 
        ...d.data(), 
        active: d.data().active !== false 
      }));

      window.displayLecturesEasy();
      window.updateStats();
    } catch (e) {
      console.error(e);
      document.getElementById('lecturesEasyContainer').innerHTML = `<div class="empty-friendly">âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£: ${e.message}</div>`;
    }
  };

  // ========== Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ ÙƒØ±ÙˆØª Ø³Ù‡Ù„Ø© ==========
  window.displayLecturesEasy = function() {
    let container = document.getElementById('lecturesEasyContainer');
    if (!window.lectures.length) {
      container.innerHTML = `<div class="empty-friendly"><i class="fas fa-smile" style="font-size:4rem;"></i><h3>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ø¶Ù Ù…Ø­Ø§Ø¶Ø±Ø§ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹</h3></div>`;
      return;
    }

    let html = '';
    window.lectures.forEach(lect => {
      // Ø£ÙƒÙˆØ§Ø¯ ØªØ®Øµ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©
      let lectureCodes = window.codes.filter(c => c.lectureName === lect.col);
      
      // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
      if (window.filterStatus === 'used') lectureCodes = lectureCodes.filter(c => c.active === false);
      else if (window.filterStatus === 'unused') lectureCodes = lectureCodes.filter(c => c.active === true);
      
      // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø«
      if (window.searchWord.trim()) {
        const term = window.searchWord.toLowerCase();
        lectureCodes = lectureCodes.filter(c => 
          c.code?.toLowerCase().includes(term) || 
          lect.col?.toLowerCase().includes(term) ||
          lect.grade?.toLowerCase().includes(term)
        );
      }

      const usedCount = lectureCodes.filter(c => c.active === false).length;
      const unusedCount = lectureCodes.filter(c => c.active === true).length;

      html += `
        <div class="lecture-simple-card">
          <div class="lecture-head">
            <span class="lecture-name">
              <i class="fas fa-video"></i> ${lect.col || 'Ù…Ø­Ø§Ø¶Ø±Ø©'}
            </span>
            <span class="paid-badge"><i class="fas fa-tag"></i> ${lect.paid === 'paid' ? 'Ù…Ø¯ÙÙˆØ¹' : 'Ù…Ø¬Ø§Ù†ÙŠ'}</span>
          </div>
          <div class="lecture-meta">
            <span class="meta-tag"><i class="fas fa-graduation-cap"></i> ${lect.grade || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
            <span class="meta-tag"><i class="fas fa-book"></i> ${lect.subject || ''}</span>
            <span class="meta-tag price-highlight"><i class="fas fa-money-bill-wave"></i> ${lect.price || 0} Ø¬.Ù…</span>
          </div>

          <div class="codes-mini-header">
            <h3><i class="fas fa-key"></i> Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ (${lectureCodes.length})</h3>
            <span class="code-stats-badge">âœ“ ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù… ${unusedCount} | âœ— ${usedCount}</span>
          </div>
          
          <div class="codes-mini-list">
            ${window.generateCompactCodes(lectureCodes, lect)}
          </div>
          
          <div class="lecture-simple-actions">
            <button class="action-simple" onclick="window.selectAllOfLecture('${lect.id}', '${lect.col}')"><i class="fas fa-check-double"></i> ØªØ­Ø¯ÙŠØ¯ ÙƒÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</button>
            <button class="action-simple add-code-btn" onclick="window.genCodesForLecture('${lect.id}', '${lect.col}')"><i class="fas fa-plus-circle"></i> ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯</button>
          </div>
        </div>
      `;
    });

    container.innerHTML = html || `<div class="empty-friendly">ğŸ” Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„ÙÙ„ØªØ±Ø©</div>`;
  };

  // ========== ØªÙˆÙ„ÙŠØ¯ ÙƒØ±ÙˆØª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© ==========
  window.generateCompactCodes = function(codeList, lecture) {
    if (!codeList.length) return '<p style="padding: 20px; text-align:center;">ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙƒÙˆØ§Ø¯</p>';
    
    let out = '';
    codeList.forEach(c => {
      const isSelected = window.selectedCodes.some(s => s.code === c.code);
      const used = c.active === false;
      const date = c.createdAt?.toDate ? new Date(c.createdAt.toDate()).toLocaleDateString('ar-EG') : '';
      
      out += `
        <div class="code-mini-item ${used ? 'used' : 'unused'}">
          <div class="row-1">
            <span class="status-chip ${used ? 'chip-used' : 'chip-unused'}">
              <i class="fas ${used ? 'fa-times-circle' : 'fa-check-circle'}"></i> ${used ? 'Ù…Ø³ØªØ®Ø¯Ù…' : 'ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…'}
            </span>
            <span class="lecture-tag-sm"><i class="fas fa-book"></i> ${lecture.grade || ''}</span>
          </div>
          
          <div class="code-price-sm">
            <span><i class="fas fa-money-bill-wave"></i> Ø³Ø¹Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©</span>
            <span style="font-weight: 800;">${lecture.price || 0} Ø¬.Ù…</span>
          </div>
          
          <div class="code-digits" dir="ltr">${c.code}</div>
          
          <div class="code-footer-simple">
            <span class="date-small"><i class="far fa-calendar"></i> ${date}</span>
            <button class="select-btn ${isSelected ? 'selected' : ''}" onclick="window.toggleSelectCode('${c.code}', '${lecture.id}', '${lecture.col}')">
              <i class="fas ${isSelected ? 'fa-check-circle' : 'fa-circle'}"></i> ${isSelected ? 'Ù…Ø­Ø¯Ø¯' : 'ØªØ­Ø¯ÙŠØ¯'}
            </button>
          </div>
        </div>
      `;
    });
    return out;
  };

  // ========== ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ==========
  window.toggleSelectCode = function(code, lectureId, lectureName) {
    const idx = window.selectedCodes.findIndex(s => s.code === code);
    const codeObj = window.codes.find(c => c.code === code);
    const lecture = window.lectures.find(l => l.id === lectureId);
    
    if (idx === -1) {
      window.selectedCodes.push({
        code, lectureId, lectureName,
        grade: lecture?.grade || '',
        price: lecture?.price || 0,
        active: codeObj?.active,
        createdAt: codeObj?.createdAt
      });
    } else window.selectedCodes.splice(idx, 1);
    
    window.displayLecturesEasy();
    window.updateStats();
  };

  window.selectAllOfLecture = function(lectureId, lectureName) {
    const lecture = window.lectures.find(l => l.id === lectureId);
    const codes = window.codes.filter(c => c.lectureName === lectureName);
    codes.forEach(c => {
      if (!window.selectedCodes.some(s => s.code === c.code)) {
        window.selectedCodes.push({ code: c.code, lectureId, lectureName, grade: lecture?.grade, price: lecture?.price, active: c.active, createdAt: c.createdAt });
      }
    });
    window.displayLecturesEasy();
    window.updateStats();
  };

  // ========== ØªÙˆÙ„ÙŠØ¯ Ø§ÙƒÙˆØ§Ø¯ ==========
  window.genCodesForLecture = async function(lectureId, lectureName) {
    let count = prompt('Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯', '5');
    if (!count) return;
    let gen = 0;
    for (let i=0; i<parseInt(count); i++) {
      let newCode, unique = false;
      while (!unique) {
        newCode = Math.floor(100000 + Math.random() * 900000).toString();
        unique = !window.codes.some(c => c.code === newCode);
      }
      try {
        await setDoc(doc(db, "codes", newCode), {
          code: newCode, lectureName, active: true, createdAt: new Date(), lectureId
        });
        gen++;
      } catch(e) {}
    }
    if (gen) { await window.loadData(); alert(`âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${gen} ÙƒÙˆØ¯`); }
  };

  window.generateForAll = async function() {
    let count = prompt('Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù„ÙƒÙ„ Ù…Ø­Ø§Ø¶Ø±Ø©', '2');
    if (!count) return;
    for (let lec of window.lectures) {
      for (let i=0; i<parseInt(count); i++) {
        let newCode, unique = false;
        while (!unique) {
          newCode = Math.floor(100000 + Math.random() * 900000).toString();
          unique = !window.codes.some(c => c.code === newCode);
        }
        await setDoc(doc(db, "codes", newCode), { code: newCode, lectureName: lec.col, active: true, createdAt: new Date(), lectureId: lec.id }).catch(()=>{});
      }
    }
    await window.loadData();
    alert('âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯');
  };

  // ========== Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ==========
  window.updateStats = function() {
    const total = window.codes.length;
    const used = window.codes.filter(c => c.active === false).length;
    const unused = window.codes.filter(c => c.active === true).length;
    const sel = window.selectedCodes.length;
    
    document.getElementById('headerLectures').innerText = window.lectures.length;
    document.getElementById('headerCodes').innerText = total;
    document.getElementById('headerSelected').innerText = sel;
    document.getElementById('statTotalCodes').innerText = total;
    document.getElementById('statUnusedCodes').innerText = unused;
    document.getElementById('statUsedCodes').innerText = used;
    document.getElementById('statSelectedPrint').innerText = sel;
    document.getElementById('printCountBadge').innerText = sel;
  };

  // ========== Ø¨Ø­Ø« ==========
  document.getElementById('simpleSearch').addEventListener('input', (e) => {
    window.searchWord = e.target.value;
    window.displayLecturesEasy();
  });

  // ========== ÙÙ„ØªØ± ==========
  window.setFilter = function(status, btn) {
    window.filterStatus = status;
    document.querySelectorAll('.filter-option').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    window.displayLecturesEasy();
  };

  // ========== ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù…ÙˆÙØ±Ø© Ù„Ù„ÙˆØ±Ù‚ â€“ 4 Ø£Ø¹Ù…Ø¯Ø© Ù…Ø¯Ù…Ø¬Ø© ==========
  window.openPrintView = function() {
    if (!window.selectedCodes.length) { alert('âš ï¸ Ø­Ø¯Ø¯ ÙƒÙˆØ¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'); return; }
    
    const panel = document.getElementById('printPanel');
    const printContainer = document.getElementById('printCodesContainer');
    const dateSpan = document.getElementById('printDateSpan');
    
    dateSpan.innerText = new Date().toLocaleDateString('ar-EG', { year:'numeric', month:'long', day:'numeric' });
 // âœ… Ø§Ø¹Ø±Ø¶ ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø·
const printableCodes = window.selectedCodes.filter(item => {
  const codeData = window.codes.find(c => c.code === item.code);
  return codeData?.active === true;   // â† ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
});

let printHTML = '';

printableCodes.forEach(item => {
  const codeData = window.codes.find(c => c.code === item.code);
  const lec = window.lectures.find(l => l.id === item.lectureId);

  // ğŸ‘‡ ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… = active === true
  const unused = codeData?.active === true;

  const date = codeData?.createdAt?.toDate
    ? new Date(codeData.createdAt.toDate()).toLocaleDateString('ar-EG')
    : '';

  printHTML += `
    <div class="print-code-card" style="border: 1.2px solid #000; padding: 8px; border-radius: 10px;">
      <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
        <span style="background: ${unused?'#d4f0d4':'#ffd9d9'}; padding:2px 10px; border-radius:30px; font-size:9px;">
          ${unused?'ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…':'Ù…Ø³ØªØ®Ø¯Ù…'}
        </span>
        <span style="font-size:9px;">${lec?.grade || ''}</span>
      </div>

      <div style="font-size:15px; font-weight:800; font-family: monospace; text-align:center; letter-spacing:2px; direction:ltr;">
        ${item.code}
      </div>

      <div style="display:flex; justify-content:space-between; margin-top:6px; font-size:8px;">
        <span>ğŸ“… ${date}</span>
        <span>ğŸ’° ${lec?.price || 0} Ø¬.Ù…</span>
      </div>

      <div style="font-size:8px; color:#333; margin-top:4px;">
        ${item.lectureName}
      </div>
    </div>
  `;
});

    
    printContainer.innerHTML = printHTML;
    panel.style.display = 'block';
  };

  window.printPaper = function() { window.print(); };
  window.closePrintPanel = function() { document.getElementById('printPanel').style.display = 'none'; };
  
  window.openPrintWindow = window.openPrintView; // ØªÙˆØ§ÙÙ‚
  window.closePrintWindow = window.closePrintPanel;

  // Ø¨Ø¯Ø¡
  window.loadData();
  setInterval(window.loadData, 30000);
</script>
</body>
</html>