<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://mr-alaa.vercel.app/logo.png" type="image/png">
    <title>register</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
 <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getFirestore, collection, addDoc, doc, setDoc } 
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBB-L6uhazoGVYg2lkphimDMbdjFhrfXjw",
  authDomain: "login-87618.firebaseapp.com",
  projectId: "login-87618",
  storageBucket: "login-87618.firebasestorage.app",
  messagingSenderId: "915916987311",
  appId: "1:915916987311:web:0da484d712d79b50916d5a"
};

const app = initializeApp(firebaseConfig);
window.db = getFirestore(app);
window.doc = doc;
window.setDoc = setDoc;

</script>


</head>
<body>
    <div class="page-layout">

  <!-- ØµÙˆØ±Ø© Ø«Ø§Ø¨ØªØ© ÙÙŠ Ø§Ù„Ø¬Ù†Ø¨ -->
  <div class="side-image">
    <img src="4fe4035e77e13a6c11c4539d799c1031 (1).jpg">
  </div>

  <!-- Ø§Ù„ÙÙˆØ±Ù… ÙÙŠ Ø§Ù„Ø¬Ù†Ø¨ Ø§Ù„Ø¢Ø®Ø± -->
  <div class="card">

    <h2>ğŸ§® Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>

    <label>Ø§Ù„Ø§Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ</label>
    <input id="name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ" required>

    <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø·Ø§Ù„Ø¨</label>
    <input id="studentPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" maxlength="11">

    <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ ÙˆÙ„ÙŠ Ø§Ù„Ø§Ù…Ø±</label>
    <input id="parentPhone" placeholder="Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±" maxlength="11">

    <label>Ø§Ù„ØµÙ</label>
    <select id="grade">
      <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
      <option>1 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option>2 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option>3 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option>1 Ø«Ø§Ù†ÙˆÙŠ</option>
      <option>2 Ø«Ø§Ù†ÙˆÙŠ</option>
      <option>3 Ø«Ø§Ù†ÙˆÙŠ</option>
    </select>

    <label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
    <select id="gov">
      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
      <option>Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
      <option>Ø§Ù„Ø¬ÙŠØ²Ø©</option>
      <option>Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
      <option>Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
      <option>Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
      <option>Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
      <option>Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
      <option>Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
      <option>Ø£Ø³ÙŠÙˆØ·</option>
      <option>Ø³ÙˆÙ‡Ø§Ø¬</option>
    </select>

    <label>ID</label>
    <input id="studentID" placeholder="Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ø§Ù„Ø¨" readonly>

    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <input id="password" type="password" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

    <button onclick="register()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>

    <div class="result" id="result">
<div class="result" id="result" style="display:none;">
  <h3>ğŸ‰ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h3>
  <p>ğŸ”“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­</p>

  <div class="login-card">
    <p><b>ğŸ†” Ù…Ø¹Ø±ÙÙƒ:</b> <span id="showID"></span></p>
    <p><b>ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</b> <span id="showPass"></span></p>
  </div>

  <button id="goPageBtn" onclick="goToGradePage()">â¡ï¸ Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØµÙÙƒ</button>
</div>
    </div>

  </div>

</div>

<script>
function generateID(){
  return Math.floor(1000 + Math.random() * 9000).toString();
}

window.onload = function(){
  document.getElementById("studentID").value = generateID();
};

function validPhone(num){
  return /^(010|011|012|015)\d{8}$/.test(num);
}

async function register(){
  let name = document.getElementById("name").value.trim();
  let sPhone = document.getElementById("studentPhone").value.trim();
  let pPhone = document.getElementById("parentPhone").value.trim();
  let grade = document.getElementById("grade").value;
  let gov = document.getElementById("gov").value;
  let pass = document.getElementById("password").value;
  let id = document.getElementById("studentID").value;

  if(name.split(" ").length < 3){
    alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ÙƒØ§Ù…Ù„!");
    return;
  }

  if(!validPhone(sPhone)){
    alert("Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ø§Ø²Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 010/011/012/015 ÙˆÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…!");
    return;
  }

  if(pPhone.length < 10){
    alert("Ø§ÙƒØªØ¨ Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ØµØ­ÙŠØ­!");
    return;
  }

  if(!grade || !gov || pass.length < 4){
    alert("Ø§ÙƒÙ…Ù„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
    return;
  }

  let studentData = {
    id: id,
    name: name,
    studentPhone: sPhone,
    parentPhone: pPhone,
    grade: grade,
    governorate: gov,
    password: pass,
    createdAt: new Date()
  };

  try {
    const studentRef = window.doc(window.db, "students", id);
    await window.setDoc(studentRef, studentData);

    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    document.getElementById("result").style.display = "block";
    document.getElementById("showID").innerText = id;
    document.getElementById("showPass").innerText = pass;

    // Ù†Ø®Ø²Ù† Ø§Ù„ØµÙ Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØµÙØ­Ø©
    window.selectedGrade = grade;

  } catch (err) {
    alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸: " + err.message);
  }
}

// Ø²Ø± Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„ØµÙØ­Ø© Ø§Ù„ØµÙ
function goToGradePage(){
  let g = window.selectedGrade;

  let pages = {
    "1 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ": "/prep-1",
    "2 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ": "/prep-2",
    "3 Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ": "/prep-3",
    "1 Ø«Ø§Ù†ÙˆÙŠ": "/sec-1",
    "2 Ø«Ø§Ù†ÙˆÙŠ": "/sec-1",
    "3 Ø«Ø§Ù†ÙˆÙŠ": "/sec-1"
  };

  window.location.href = pages[g];
}
</script>



</body>
</html>